<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>VPN IP</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<style>
body { font-family: sans-serif; text-align:center; margin-top: 40px; }
button { padding: 10px 20px; font-size: 16px; margin-top: 20px; cursor:pointer; }
#hint {display:none; color:#555;}
</style>
</head>
<body>
<h3>–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ IP...</h3>
<div id="result">‚è≥ –ü–æ–ª—É—á–∞—é IP...</div>
<p id="hint"></p>
<button id="sendBtn" style="display:none;">üì§ –û—Ç–ø—Ä–∞–≤–∏—Ç—å IP</button>

<script>
window.addEventListener('DOMContentLoaded', () => {
  if (window.Telegram && Telegram.WebApp) {
    Telegram.WebApp.ready();
  }
});

let ip = "";
const botname = "intercomIPbot";

fetch('https://api.ipify.org?format=json')
  .then(r=>r.json())
  .then(d=>{
    ip = d.ip;
    document.getElementById('result').innerText='–í–∞—à IP: '+ip;
    const hintEl = document.getElementById('hint');
    hintEl.innerHTML = 'üì¢ –ü–æ—Å–ª–µ –∑–∞–∫—Ä—ã—Ç–∏—è –æ–∫–Ω–∞ –Ω–∞–∂–º–∏—Ç–µ "–û—Ç–ø—Ä–∞–≤–∏—Ç—å", —á—Ç–æ–±—ã –ø–µ—Ä–µ–¥–∞—Ç—å IP –±–æ—Ç—É.';
    hintEl.style.display = "block";
    document.getElementById('sendBtn').style.display = "inline-block";
  });

document.getElementById('sendBtn').onclick = ()=>{
  const link = `https://t.me/${botname}?startapp=sendip_${ip}`;
  if (window.Telegram && Telegram.WebApp) {
    Telegram.WebApp.close();
  }
  setTimeout(()=>{ window.location.href = link; }, 400);
};
</script>
</body>
</html>
