<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>VPN IP v8</title>
<style>
    body { font-family: Arial, sans-serif; text-align:center; margin-top: 40px; background-color: #f8f9fa; }
    h2 { color: #444; }
    #result { font-size: 18px; margin: 20px 0; }
    button { padding: 12px 24px; font-size: 16px; margin-top: 20px; cursor:pointer; border:none; border-radius:5px; background-color:#007bff; color:#fff; }
    button:hover { background-color:#0056b3; }
    #status { margin-top: 15px; color: #333; white-space: pre-line; }
    a { display:block; margin-top:10px; color:#007bff; text-decoration:none; }
    a:hover { text-decoration:underline; }
</style>
</head>
<body>
    <h2>WebApp v8</h2>
    <h3>–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ IP-–∞–¥—Ä–µ—Å–∞</h3>
    <div id="result">‚è≥ –ü–æ–ª—É—á–∞—é IP...</div>
    <button id="sendBtn" style="display:none;">üì§ –û—Ç–ø—Ä–∞–≤–∏—Ç—å IP</button>
    <div id="status"></div>
    <a id="manualLink" href="#" style="display:none;">üîó –û—Ç–∫—Ä—ã—Ç—å –±–æ—Ç–∞ –≤—Ä—É—á–Ω—É—é</a>

<script>
let ip = "";
const botname = "intercomIPbot"; // üëà –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –∏–º—è –≤–∞—à–µ–≥–æ –±–æ—Ç–∞

// –ü–æ–ª—É—á–µ–Ω–∏–µ IP
fetch('https://ipv4.icanhazip.com', {cache:'no-store'})
  .then(r => r.text())
  .then(d => {
      ip = d.trim();
      document.getElementById('result').innerText = '–í–∞—à IP: ' + ip;
      document.getElementById('sendBtn').style.display = "inline-block";
  })
  .catch(e => {
      document.getElementById('result').innerText = '–û—à–∏–±–∫–∞: ' + e;
  });

// –û—Ç–ø—Ä–∞–≤–∫–∞ IP
document.getElementById('sendBtn').onclick = ()=>{
    const status = document.getElementById('status');
    const manualLink = document.getElementById('manualLink');
    if (!ip) {
        status.innerText = "‚ùå IP-–∞–¥—Ä–µ—Å –Ω–µ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω";
        return;
    }
    status.innerText = "üì® –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤ Telegram –±–æ—Ç–∞...";
    
    const linkTG = `tg://resolve?domain=${botname}&start=sendip_${ip}`;
    const linkWeb = `https://t.me/${botname}?start=sendip_${ip}`;
    
    // –ü–æ–ø—ã—Ç–∫–∞ –æ—Ç–∫—Ä—ã—Ç—å –Ω–∞–ø—Ä—è–º—É—é Telegram
    let redirected = false;
    try {
        window.location.href = linkTG;
        redirected = true;
    } catch (e) {
        console.log("‚ö†Ô∏è –ü—Ä—è–º–æ–π –≤—ã–∑–æ–≤ Telegram –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª, –ø—Ä–æ–±—É—é web...");
    }

    // Fallback —á–µ—Ä–µ–∑ 1 —Å–µ–∫—É–Ω–¥—É
    setTimeout(() => {
        if (!redirected) {
            window.location.href = linkWeb;
        }
    }, 1000);

    // –°—Å—ã–ª–∫–∞ –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –æ—Ç–∫—Ä—ã—Ç–∏—è
    manualLink.href = linkWeb;
    manualLink.style.display = "block";
    manualLink.innerText = "üîó –ï—Å–ª–∏ –±–æ—Ç –Ω–µ –æ—Ç–∫—Ä—ã–ª—Å—è, –Ω–∞–∂–º–∏—Ç–µ –∑–¥–µ—Å—å";
};
</script>
</body>
</html>
