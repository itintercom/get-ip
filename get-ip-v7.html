<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>VPN IP v7</title>
<style>
    body { font-family: Arial, sans-serif; text-align:center; margin-top: 40px; background-color: #f8f9fa; }
    h2 { color: #444; }
    #result { font-size: 18px; margin: 20px 0; }
    button { padding: 12px 24px; font-size: 16px; margin-top: 20px; cursor:pointer; border:none; border-radius:5px; background-color:#007bff; color:#fff; }
    button:hover { background-color:#0056b3; }
    #status { margin-top: 15px; color: #333; white-space: pre-line; }
</style>
</head>
<body>
    <h2>WebApp v7</h2>
    <h3>–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ IP-–∞–¥—Ä–µ—Å–∞</h3>
    <div id="result">‚è≥ –ü–æ–ª—É—á–∞—é IP...</div>
    <button id="sendBtn" style="display:none;">üì§ –û—Ç–ø—Ä–∞–≤–∏—Ç—å IP</button>
    <div id="status"></div>

<script>
let ip = "";
const botname = "intercomIPbot"; // üëà –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –∏–º—è –≤–∞—à–µ–≥–æ –±–æ—Ç–∞

// –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—É–±–ª–∏—á–Ω–æ–≥–æ IP
fetch('https://ipv4.icanhazip.com', {cache:'no-store'})
  .then(r => r.text())
  .then(d => {
      ip = d.trim();
      console.log("‚úÖ [v7] –ü–æ–ª—É—á–µ–Ω IP:", ip);
      document.getElementById('result').innerText = '–í–∞—à IP: ' + ip;
      document.getElementById('sendBtn').style.display = "inline-block";
  })
  .catch(e => {
      console.error("‚ùå [v7] –û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è IP:", e);
      document.getElementById('result').innerText = '–û—à–∏–±–∫–∞: ' + e;
  });

// –û—Ç–ø—Ä–∞–≤–∫–∞ IP —á–µ—Ä–µ–∑ deep-link
document.getElementById('sendBtn').onclick = ()=>{
    const status = document.getElementById('status');
    if (!ip) {
        status.innerText = "‚ùå IP-–∞–¥—Ä–µ—Å –Ω–µ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω";
        return;
    }
    status.innerText = "üì® –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤ Telegram –±–æ—Ç–∞...";
    const link = `https://t.me/${botname}?start=sendip_${ip}`;
    console.log("üîó [v7] –ü–µ—Ä–µ—Ö–æ–¥ –ø–æ —Å—Å—ã–ª–∫–µ:", link);
    window.location.href = link;
};
</script>
</body>
</html>
